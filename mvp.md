DÆ°á»›i Ä‘Ã¢y lÃ  **Ä‘á» xuáº¥t MVP cho sáº£n pháº©m y táº¿ sá»‘ (Health MVP)** táº­p trung vÃ o **truyá»n táº£i kiáº¿n thá»©c nhanh â€“ theo timeline â€“ theo dÃµi triá»‡u chá»©ng phá»¥ â€“ cáº£nh bÃ¡o sá»›m â€“ check-in háº±ng ngÃ y**. MÃ¬nh trÃ¬nh bÃ y theo gÃ³c nhÃ¬n **product + architecture**, phÃ¹ há»£p Ä‘á»ƒ build nhanh vÃ  validate thá»‹ trÆ°á»ng.

---

## 1. Ã tÆ°á»Ÿng cá»‘t lÃµi (Core Value Proposition)

> **â€œMá»™t trá»£ lÃ½ y táº¿ cÃ¡ nhÃ¢n, giÃºp ngÆ°á»i dÃ¹ng hiá»ƒu Ä‘Ãºng â€“ theo dÃµi Ä‘Ãºng â€“ cáº£nh bÃ¡o sá»›m cÃ¡c váº¥n Ä‘á» sá»©c khá»e theo thá»i gian.â€**

Giáº£i quyáº¿t cÃ¡c pain points:

* NgÆ°á»i dÃ¹ng **khÃ´ng hiá»ƒu triá»‡u chá»©ng** â†’ chá»§ quan
* Kiáº¿n thá»©c y táº¿ **rá»i ráº¡c, khÃ³ nhá»›**
* KhÃ´ng cÃ³ **theo dÃµi liÃªn tá»¥c**
* PhÃ¡t hiá»‡n muá»™n â†’ chi phÃ­ & rá»§i ro cao

---

## 2. Äá»‘i tÆ°á»£ng ngÆ°á»i dÃ¹ng MVP

Æ¯u tiÃªn **1 nhÃ³m háº¹p Ä‘á»ƒ validate**:

* NgÆ°á»i:

  * Ä‘ang Ä‘iá»u trá»‹ bá»‡nh máº¡n (viÃªm xoang, dáº¡ dÃ y, huyáº¿t Ã¡pâ€¦)
  * sau tiÃªm vaccine / sau pháº«u thuáº­t
  * cÃ³ bá»‡nh ná»n cáº§n theo dÃµi triá»‡u chá»©ng phá»¥
* Äá»™ tuá»•i: 25â€“55
* CÃ³ smartphone, sáºµn sÃ ng check-in háº±ng ngÃ y

---

## 3. CÃ¡c tÃ­nh nÄƒng MVP (Must-have)

### 3.1 Timeline y táº¿ cÃ¡ nhÃ¢n (Medical Timeline)

![Image](https://cdn.dribbble.com/userupload/45037774/file/8ed946d79fcd2446ad3618e10ac2bd37.png)

![Image](https://www.lymedisease.org/wp-content/uploads/2019/06/lifeevent_closeup.jpg)

![Image](https://cdn.dribbble.com/userupload/20446136/file/original-673c39fb5ed0547524518bc0e68ad68e.png?resize=752x\&vertical=center)

* DÃ²ng thá»i gian theo ngÃ y / tuáº§n
* Ghi nháº­n:

  * triá»‡u chá»©ng chÃ­nh
  * triá»‡u chá»©ng phá»¥
  * thuá»‘c Ä‘Ã£ dÃ¹ng
  * sá»± kiá»‡n y táº¿ (tiÃªm, khÃ¡m, test)
* CÃ³ **pattern theo thá»i gian**

ğŸ‘‰ GiÃ¡ trá»‹: *Hiá»ƒu diá»…n biáº¿n, khÃ´ng chá»‰ tráº¡ng thÃ¡i hiá»‡n táº¡i*

---

### 3.2 TrÃ¬nh bÃ y kiáº¿n thá»©c nhanh (Micro Medical Knowledge)

![Image](https://images.template.net/512684/Simple-Medical-Health-Infographic-Template-edit-online.png)

![Image](https://www.brainscape.com/academy/content/images/2022/02/Brainscape-flashcards-app-in-the-app-store.png)

![Image](https://files.unitypoint.org/api/public/content/d2e1d95312be48238e675a5d8a916961?v=2b79388e)

* Kiáº¿n thá»©c dáº¡ng:

  * tháº» ngáº¯n (card)
  * 30â€“60 giÃ¢y Ä‘á»c
* Gáº¯n **trá»±c tiáº¿p vá»›i triá»‡u chá»©ng**

  * â€œÄau Ä‘áº§u + ngháº¹t mÅ©i â†’ cÃ³ thá»ƒ liÃªn quan xoangâ€
* CÃ³ 3 má»©c:

  * ğŸŸ¢ BÃ¬nh thÆ°á»ng
  * ğŸŸ¡ Theo dÃµi
  * ğŸ”´ Cáº§n cáº£nh bÃ¡o

ğŸ‘‰ KhÃ´ng dáº¡y y há»c, chá»‰ **giÃºp hiá»ƒu & pháº£n á»©ng Ä‘Ãºng**

---

### 3.3 Check-in sá»©c khá»e háº±ng ngÃ y (Daily Health Check)

![Image](https://s3-alpha.figma.com/hub/file/6867224067/a51156ef-4eb5-41a8-af98-42e8805405fe-cover.png)

![Image](https://a.storyblok.com/f/120667/1046x916/3fece6f484/screen-shots-symptom-checker.png/m/1800x0/filters%3Aformat%28webp%29)

![Image](https://m.media-amazon.com/images/I/612iAS3b6tL._AC_UF1000%2C1000_QL80_.jpg)

* 3â€“5 cÃ¢u há»i/ngÃ y:

  * Má»©c Ä‘au (0â€“10)
  * Triá»‡u chá»©ng má»›i?
  * Uá»‘ng thuá»‘c Ä‘á»§ chÆ°a?
  * Ngá»§ / Äƒn / váº­n Ä‘á»™ng
* UX: **< 30 giÃ¢y**

ğŸ‘‰ Dá»¯ liá»‡u sá»‘ng Ä‘á»ƒ feed cho alert engine

---

### 3.4 Alert & Early Warning Engine

![Image](https://www.researchgate.net/publication/318476195/figure/fig2/AS%3A716502412046336%401547838895146/Detailed-design-of-health-alert-system.png)

![Image](https://www.seniorliving.org/app/uploads/2024/02/Red-Panic-Button.png)

![Image](https://www.slideteam.net/media/catalog/product/cache/1280x720/i/n/incident_escalation_management_workflow_chart_slide01.jpg)

* Rule-based (MVP):

  * Triá»‡u chá»©ng X kÃ©o dÃ i > N ngÃ y
  * Má»©c Ä‘á»™ tÄƒng liÃªn tá»¥c
  * Káº¿t há»£p nhiá»u triá»‡u chá»©ng nguy hiá»ƒm
* Alert:

  * Push notification
  * Message rÃµ rÃ ng: *â€œBáº¡n nÃªn Ä‘i khÃ¡mâ€*, *â€œTheo dÃµi thÃªm 24hâ€*

ğŸ‘‰ GiÃ¡ trá»‹ lá»›n nháº¥t cá»§a sáº£n pháº©m

---

## 4. Kiáº¿n trÃºc MVP (Low-cost, build nhanh)

### 4.1 Tá»•ng thá»ƒ

```
Mobile App (iOS / Android / Web)
        |
        v
Backend API (Rails / NestJS)
        |
        |-- User Timeline
        |-- Symptom Logs
        |-- Alert Rules Engine
        |
Knowledge Base (Static + AI-assisted)
```

---

### 4.2 Tech stack Ä‘á» xuáº¥t

**Frontend**

* Next.js (Web)
* React Native / Expo (Mobile)
* Push: Firebase Cloud Messaging

**Backend**

* Rails hoáº·c NestJS
* PostgreSQL
* Redis (rule & cache)

**AI (optional â€“ phase 2)**

* LLM:

  * Mapping triá»‡u chá»©ng â†’ kiáº¿n thá»©c
  * TÃ³m táº¯t timeline cho user / bÃ¡c sÄ©

---

## 5. Data model Ä‘Æ¡n giáº£n (MVP-ready)

```text
User
- id
- age
- gender
- conditions (tags)

DailyCheckin
- user_id
- date
- symptom_scores
- notes

SymptomEvent
- user_id
- symptom_type
- severity
- timestamp

Alert
- user_id
- rule_triggered
- severity
- created_at
```

---

## 6. Kháº£ nÄƒng má»Ÿ rá»™ng sau MVP

* Export timeline PDF cho bÃ¡c sÄ©
* Káº¿t ná»‘i wearable (Apple Health, Fitbit)
* AI dá»± Ä‘oÃ¡n risk score
* BÃ¡c sÄ© / clinic dashboard
* Subscription B2C hoáº·c B2B2C (phÃ²ng khÃ¡m, báº£o hiá»ƒm)

---

## 7. KPI Ä‘á»ƒ validate MVP

* % ngÆ°á»i check-in > 5 ngÃ y liÃªn tiáº¿p
* Thá»i gian Ä‘á»c kiáº¿n thá»©c < 1 phÃºt
* % alert Ä‘Æ°á»£c user pháº£n há»“i
* Retention 7 ngÃ y / 14 ngÃ y

---

## 8. TÃ³m táº¯t 1 cÃ¢u Ä‘á»ƒ pitch

> **â€œá»¨ng dá»¥ng giÃºp ngÆ°á»i dÃ¹ng theo dÃµi sá»©c khá»e theo thá»i gian, hiá»ƒu Ä‘Ãºng triá»‡u chá»©ng, vÃ  nháº­n cáº£nh bÃ¡o sá»›m trÆ°á»›c khi tÃ¬nh tráº¡ng trá»Ÿ nÃªn nghiÃªm trá»ng.â€**

---


DÆ°á»›i Ä‘Ã¢y lÃ  **thiáº¿t káº¿ Alert Rule chi tiáº¿t (MVP-ready)** cho sáº£n pháº©m y táº¿ cá»§a báº¡n, theo hÆ°á»›ng **rule-based + timeline-aware**, Ä‘á»§ máº¡nh Ä‘á»ƒ **táº¡o giÃ¡ trá»‹ sá»›m** mÃ  **chÆ°a cáº§n AI phá»©c táº¡p**.

---

## 1. Triáº¿t lÃ½ thiáº¿t káº¿ Alert Rule (ráº¥t quan trá»ng)

Alert **KHÃ”NG** nháº±m:

* Cháº©n Ä‘oÃ¡n bá»‡nh âŒ
* Thay tháº¿ bÃ¡c sÄ© âŒ

Alert **NÃŠN**:

* PhÃ¡t hiá»‡n **xu hÆ°á»›ng xáº¥u theo thá»i gian**
* PhÃ¡t hiá»‡n **tá»• há»£p triá»‡u chá»©ng nguy hiá»ƒm**
* ThÃºc Ä‘áº©y **hÃ nh Ä‘á»™ng Ä‘Ãºng lÃºc**

ğŸ‘‰ Keyword: **Trend > Snapshot**

---

## 2. PhÃ¢n loáº¡i Alert (Severity Model)

| Level    | MÃ u | Ã nghÄ©a      | HÃ nh Ä‘á»™ng     |
| -------- | --- | ------------ | ------------- |
| INFO     | ğŸŸ¢  | BÃ¬nh thÆ°á»ng  | Chá»‰ hiá»ƒn thá»‹  |
| WATCH    | ğŸŸ¡  | Cáº§n theo dÃµi | Nháº¯c check-in |
| WARNING  | ğŸŸ   | Nguy cÆ¡      | Gá»£i Ã½ Ä‘i khÃ¡m |
| CRITICAL | ğŸ”´  | Nguy hiá»ƒm    | Cáº£nh bÃ¡o kháº©n |

---

## 3. NhÃ³m Alert Rules chÃ­nh

---

## 3.1 Rule nhÃ³m A â€“ Timeline-based (Theo thá»i gian)

### A1. Triá»‡u chá»©ng kÃ©o dÃ i báº¥t thÆ°á»ng

```yaml
rule: symptom_duration_exceeded
if:
  symptom = X
  severity >= 4
  duration >= N_days
then:
  alert = WARNING
```

ğŸ“Œ VÃ­ dá»¥:

* Ngháº¹t mÅ©i â‰¥ 5 ngÃ y
* Äau Ä‘áº§u â‰¥ 3 ngÃ y liÃªn tá»¥c
* Ho â‰¥ 7 ngÃ y

ğŸ‘‰ GiÃ¡ trá»‹: phÃ¡t hiá»‡n **máº¡n tÃ­nh hÃ³a**

---

### A2. Severity tÄƒng dáº§n (Trend escalation)

```yaml
rule: severity_increasing
if:
  severity[today] - severity[3_days_ago] >= 3
then:
  alert = WARNING
```

ğŸ“Œ VÃ­ dá»¥:

* Äau tá»« 3 â†’ 7 trong 3 ngÃ y
* ChÃ³ng máº·t tÄƒng Ä‘á»u

ğŸ‘‰ Quan trá»ng hÆ¡n 1 láº§n Ä‘au náº·ng

---

### A3. Check-in bá»‹ giÃ¡n Ä‘oáº¡n + cÃ³ triá»‡u chá»©ng ná»n

```yaml
rule: missing_checkin_with_symptom
if:
  missing_checkin >= 2 days
  last_symptom_severity >= 5
then:
  alert = WATCH
```

ğŸ‘‰ NgÆ°á»i bá»‡nh náº·ng thÆ°á»ng **bá» theo dÃµi**

---

## 3.2 Rule nhÃ³m B â€“ Symptom Combination (Tá»• há»£p triá»‡u chá»©ng)

![Image](https://www.researchgate.net/publication/299359938/figure/fig4/AS%3A961823100649474%401606327905099/Flow-chart-of-the-proposed-medical-diagnosis-system-according-to-10-fold-cross-validation.gif)

![Image](https://formspal.com/pdf-forms/other/emergency-decision-tree/emergency-decision-tree-preview.webp)

![Image](https://www.slideteam.net/media/catalog/product/cache/1280x720/i/n/incident_escalation_management_workflow_chart_slide01.jpg)

### B1. Tá»• há»£p nguy hiá»ƒm má»©c trung bÃ¬nh

```yaml
if:
  headache >= 5
  AND fever >= 38
then:
  alert = WARNING
```

ğŸ“Œ Logic:

* Má»™t triá»‡u chá»©ng: bÃ¬nh thÆ°á»ng
* Hai triá»‡u chá»©ng káº¿t há»£p: rá»§i ro tÄƒng

---

### B2. Tá»• há»£p nguy hiá»ƒm cao

```yaml
if:
  chest_pain >= 5
  AND shortness_of_breath = true
then:
  alert = CRITICAL
```

ğŸ‘‰ Rule **hard-coded**, khÃ´ng suy luáº­n

---

### B3. Triá»‡u chá»©ng má»›i + ná»n bá»‡nh cÃ³ sáºµn

```yaml
if:
  new_symptom = dizziness
  AND user_condition = hypertension
then:
  alert = WARNING
```

---

## 3.3 Rule nhÃ³m C â€“ Medication / Treatment

### C1. KhÃ´ng tuÃ¢n thá»§ thuá»‘c

```yaml
if:
  missed_medication >= 2 days
then:
  alert = WATCH
```

---

### C2. Triá»‡u chá»©ng phá»¥ sau thuá»‘c

```yaml
if:
  medication = antibiotic
  AND symptom = rash
then:
  alert = WARNING
```

---

### C3. KhÃ´ng cáº£i thiá»‡n sau Ä‘iá»u trá»‹

```yaml
if:
  medication_started >= 5 days
  AND severity_not_decreasing
then:
  alert = WARNING
```

---

## 3.4 Rule nhÃ³m D â€“ Event-based (Sau tiÃªm / sau thá»§ thuáº­t)

### D1. BÃ¬nh thÆ°á»ng (informative)

```yaml
if:
  post_vaccine <= 48h
  AND fever <= 38.5
then:
  alert = INFO
```

---

### D2. Báº¥t thÆ°á»ng sau má»‘c an toÃ n

```yaml
if:
  post_vaccine >= 72h
  AND fever >= 38
then:
  alert = WARNING
```

---

## 3.5 Rule nhÃ³m E â€“ Risk Score tá»•ng há»£p (MVP nÃ¢ng cao)

### E1. Risk Score Formula (Ä‘Æ¡n giáº£n)

```text
risk_score =
  symptom_severity_avg * 0.4
+ symptom_duration_days * 0.3
+ missed_checkin_days * 0.2
+ comorbidity_weight * 0.1
```

### Mapping:

* score < 3 â†’ ğŸŸ¢
* 3â€“5 â†’ ğŸŸ¡
* 5â€“7 â†’ ğŸŸ 
* > 7 â†’ ğŸ”´

ğŸ‘‰ Dá»… explain, dá»… tune

---

## 4. Alert Cooldown & Anti-spam

```yaml
alert_cooldown:
  same_rule: 24h
  same_severity: 48h
```

* KhÃ´ng spam
* Æ¯u tiÃªn alert **severity cao hÆ¡n**

---

## 5. Alert Message Template (UX cá»±c quan trá»ng)

âŒ Sai:

> â€œBáº¡n cÃ³ nguy cÆ¡ viÃªm xoangâ€

âœ… ÄÃºng:

> â€œTriá»‡u chá»©ng ngháº¹t mÅ©i cá»§a báº¡n kÃ©o dÃ i 5 ngÃ y vÃ  Ä‘ang tÄƒng. Báº¡n nÃªn cÃ¢n nháº¯c Ä‘i khÃ¡m taiâ€“mÅ©iâ€“há»ng.â€

Cáº¥u trÃºc:

1. Quan sÃ¡t
2. LÃ½ do
3. HÃ nh Ä‘á»™ng

---

## 6. Rule Engine Architecture (MVP-friendly)

```
Daily Check-in
      â†“
Normalize Symptoms
      â†“
Rule Engine (JSON/YAML)
      â†“
Alert Scoring
      â†“
Notification + Timeline Event
```

* Rule lÆ°u dáº¡ng JSON/YAML
* KhÃ´ng hard-code trong code
* Cho phÃ©p **medical advisor chá»‰nh rule**

---

## 7. Lá»™ trÃ¬nh nÃ¢ng cáº¥p (sau MVP)

* Rule há»c tá»« data (semi-AI)
* CÃ¡ nhÃ¢n hÃ³a threshold
* Explainable AI alert
* Doctor-reviewed rule set

---

## 8. CÃ¢u chá»‘t cho sáº£n pháº©m

> **â€œChÃºng tÃ´i khÃ´ng phÃ¡t hiá»‡n bá»‡nh â€“ chÃºng tÃ´i phÃ¡t hiá»‡n khi sá»©c khá»e cá»§a báº¡n Ä‘ang Ä‘i sai hÆ°á»›ng.â€**

---

DÆ°á»›i Ä‘Ã¢y lÃ  **Architecture chi tiáº¿t + Schema DB (MVP â†’ scale Ä‘Æ°á»£c)** cho sáº£n pháº©m y táº¿ cá»§a báº¡n, thiáº¿t káº¿ theo hÆ°á»›ng **rule-based alert + timeline-centric**, tá»‘i Æ°u **chi phÃ­ â€“ dá»… iterate â€“ an toÃ n y táº¿**.

---

# I. Architecture tá»•ng thá»ƒ (Logical + Physical)

![Image](https://www.researchgate.net/publication/276732354/figure/fig1/AS%3A393453000249356%401470817913889/e-Healthcare-System-Architecture.png)

![Image](https://www.researchgate.net/publication/320621590/figure/fig2/AS%3A553909087203328%401509073625314/Design-Architecture-of-Semantic-Rules-Engine.png)

![Image](https://www.researchgate.net/publication/334272323/figure/fig1/AS%3A797761209380874%401567212502893/System-architecture-of-the-mobile-personal-health-record-app-REST-REpresentational.ppm)

![Image](https://www.researchgate.net/publication/328375487/figure/fig2/AS%3A1023962679083009%401621143135273/App-system-architecture.ppm)

## 1. High-level Architecture (MVP)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Mobile / Webâ”‚
â”‚ (Inertia.js â”‚
â”‚  / Blade)   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚ REST / JSON
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Laravel API      â”‚
â”‚  (Laravel 12)     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€ User Service
       â”œâ”€â”€ Check-in Service
       â”œâ”€â”€ Timeline Service
       â”œâ”€â”€ Rule Engine Service
       â””â”€â”€ Notification Service
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Primary Data Store          â”‚
â”‚ PostgreSQL                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â”œâ”€â”€ Redis (cache, cooldown)
       â”œâ”€â”€ Laravel Queue (Redis/DB)
       â””â”€â”€ Push (FCM / APNs)
```

---

## 2. Event-driven Flow (Alert ì¤‘ì‹¬)

```
User Check-in
    â†“
Normalize Symptom Data
    â†“
Persist Raw Data
    â†“
Emit HealthEvent
    â†“
Rule Engine
    â†“
Alert Decision
    â†“
Timeline Event + Notification
```

ğŸ‘‰ **Key design**:

* **Event first** â†’ dá»… má»Ÿ rá»™ng AI sau
* **Alert khÃ´ng block user flow**

---

# II. Component Breakdown (Chi tiáº¿t)

## 1. Client (Web / Mobile)

**Nhiá»‡m vá»¥**

* Daily check-in (â‰¤30s)
* Timeline view
* Alert inbox
* Knowledge cards

**KhÃ´ng lÃ m**

* KhÃ´ng tÃ­nh toÃ¡n alert
* KhÃ´ng lÆ°u logic y táº¿

---

## 2. API Gateway

**Chá»©c nÄƒng**

* Auth (JWT)
* Rate limit
* Validation input y táº¿
* Versioning API (v1/v2)

---

## 3. Core Services

### 3.1 User Service

* Há»“ sÆ¡ sá»©c khá»e
* Bá»‡nh ná»n
* NgÆ°á»¡ng cÃ¡ nhÃ¢n (phase 2)

### 3.2 Check-in Service

* Nháº­n dá»¯ liá»‡u ngÃ y
* Chuáº©n hÃ³a symptom (enum, scale)
* Emit `HealthEvent`

### 3.3 Timeline Service

* Append-only events
* KhÃ´ng update quÃ¡ khá»© (medical integrity)

### 3.4 Rule Engine Service â­

* Load rules (JSON/YAML)
* Evaluate theo:

  * timeline
  * trend
  * combination
* Apply cooldown

### 3.5 Notification Service

* Push / Email
* Message template
* Escalation logic

---

# III. Database Schema (PostgreSQL â€“ MVP)

## 1. users

```sql
users (
  id UUID PK,
  email VARCHAR,
  age INT,
  gender VARCHAR,
  conditions JSONB, -- ["hypertension","sinusitis"]
  created_at TIMESTAMP
)
```

---

## 2. daily_checkins

```sql
daily_checkins (
  id UUID PK,
  user_id UUID FK,
  checkin_date DATE,
  overall_feeling INT, -- 1-10
  sleep_hours FLOAT,
  notes TEXT,
  created_at TIMESTAMP,
  UNIQUE(user_id, checkin_date)
)
```

---

## 3. symptoms

```sql
symptoms (
  id UUID PK,
  code VARCHAR,        -- headache, fever
  display_name VARCHAR,
  severity_scale INT, -- usually 10
  is_critical BOOLEAN
)
```

---

## 4. symptom_logs (ğŸ”¥ timeline raw data)

```sql
symptom_logs (
  id UUID PK,
  user_id UUID FK,
  symptom_code VARCHAR FK,
  severity INT,        -- 0-10
  occurred_at TIMESTAMP,
  source VARCHAR       -- checkin | manual | auto
)
```

ğŸ‘‰ **Append-only** â€“ cá»±c quan trá»ng cho y táº¿

---

## 5. medications

```sql
medications (
  id UUID PK,
  name VARCHAR,
  type VARCHAR, -- antibiotic, vaccine
  known_side_effects JSONB
)
```

---

## 6. medication_logs

```sql
medication_logs (
  id UUID PK,
  user_id UUID FK,
  medication_id UUID FK,
  taken_at TIMESTAMP,
  missed BOOLEAN
)
```

---

## 7. health_events (Event Bus DB-level)

```sql
health_events (
  id UUID PK,
  user_id UUID,
  event_type VARCHAR,  -- checkin, symptom, medication
  payload JSONB,
  occurred_at TIMESTAMP
)
```

ğŸ‘‰ ÄÃ¢y lÃ  **xÆ°Æ¡ng sá»‘ng cho Rule Engine**

---

## 8. alert_rules (Config-driven)

```sql
alert_rules (
  id UUID PK,
  code VARCHAR,
  severity VARCHAR, -- info, watch, warning, critical
  condition JSONB,
  cooldown_hours INT,
  is_active BOOLEAN
)
```

ğŸ“Œ VÃ­ dá»¥ `condition`:

```json
{
  "symptom": "fever",
  "min_severity": 38,
  "duration_days": 3
}
```

---

## 9. alerts (Generated output)

```sql
alerts (
  id UUID PK,
  user_id UUID,
  rule_code VARCHAR,
  severity VARCHAR,
  message TEXT,
  triggered_at TIMESTAMP,
  acknowledged_at TIMESTAMP
)
```

---

## 10. timeline_events (User-facing)

```sql
timeline_events (
  id UUID PK,
  user_id UUID,
  event_type VARCHAR, -- symptom, alert, knowledge
  ref_id UUID,
  occurred_at TIMESTAMP
)
```

---

# IV. Rule Engine Execution Model

```
for each HealthEvent:
  load active rules
  for rule in rules:
    if rule.match(event, timeline):
        if not cooldown_hit:
            create Alert
            append TimelineEvent
```

**Key points**

* Stateless per run
* Stateful via DB + Redis
* Deterministic â†’ audit Ä‘Æ°á»£c

---

# V. Redis Usage (Cost-effective)

| Key                          | Purpose       |
| ---------------------------- | ------------- |
| alert:cooldown:{user}:{rule} | Anti-spam     |
| user:risk_score              | cache         |
| last_checkin:{user}          | missing check |

---

# VI. Scaling Path (Sau MVP)

### Phase 2

* Alert personalization
* Risk score ML
* Doctor dashboard

### Phase 3

* Explainable AI
* Wearable integration
* Clinical-grade audit log

---

# VII. Design Principles (Y táº¿ báº¯t buá»™c)

* **Append-only medical data**
* **Explainable alerts**
* **Fail-safe (no silent failure)**
* **Rule > Model (MVP)**

---

DÆ°á»›i Ä‘Ã¢y lÃ  **Rule Set hoÃ n chá»‰nh (MVP-ready)** cho **3 nhÃ³m bá»‡nh/Ä‘á»‘i tÆ°á»£ng cá»¥ thá»ƒ** báº¡n chá»n. Thiáº¿t káº¿ theo chuáº©n **explainable â€“ rule-based â€“ timeline-aware**, dÃ¹ng Ä‘Æ°á»£c **ngay láº­p tá»©c** cho product.

---

# I. ViÃªm mÅ©i dá»‹ á»©ng (Allergic Rhinitis)

![Image](https://my.clevelandclinic.org/-/scassets/images/org/health/articles/8622-allergic-rhinitis-hay-fever)

![Image](https://cdn.sanity.io/images/0vv8moc6/contemporary_clinic/429b5db960bbc6020ae649257e43e6330dbd1953-500x375.jpg?auto=format\&fit=crop)

![Image](https://blog.ohiohealth.com/wp-content/uploads/2017/04/Cold_vs_Allergies_Infographic_695x1024_FINAL.jpg)

## 1. Symptom Model

| Code             | MÃ´ táº£     | Scale    |
| ---------------- | --------- | -------- |
| nasal_congestion | Ngháº¹t mÅ©i | 0â€“10     |
| sneezing         | Háº¯t hÆ¡i   | láº§n/ngÃ y |
| runny_nose       | Cháº£y mÅ©i  | 0â€“10     |
| itchy_nose       | Ngá»©a mÅ©i  | 0â€“10     |
| headache         | Äau Ä‘áº§u   | 0â€“10     |
| fatigue          | Má»‡t má»i   | 0â€“10     |

---

## 2. Alert Rules

### AR-01 â€“ Triá»‡u chá»©ng kÃ©o dÃ i (chuyá»ƒn máº¡n)

```yaml
code: AR_01_PERSISTENT_CONGESTION
if:
  symptom: nasal_congestion
  severity >= 5
  duration_days >= 5
then:
  severity: WARNING
  message: >
    Ngháº¹t mÅ©i cá»§a báº¡n kÃ©o dÃ i nhiá»u ngÃ y liÃªn tiáº¿p.
    ViÃªm mÅ©i dá»‹ á»©ng cÃ³ thá»ƒ Ä‘ang tiáº¿n triá»ƒn náº·ng hÆ¡n.
    Báº¡n nÃªn cÃ¢n nháº¯c Ä‘i khÃ¡m taiâ€“mÅ©iâ€“há»ng.
```

---

### AR-02 â€“ Pattern Ä‘iá»ƒn hÃ¬nh dá»‹ á»©ng

```yaml
code: AR_02_CLASSIC_ALLERGY_PATTERN
if:
  sneezing >= 10
  AND itchy_nose >= 5
  AND runny_nose >= 5
then:
  severity: WATCH
  message: >
    CÃ¡c triá»‡u chá»©ng cá»§a báº¡n phÃ¹ há»£p vá»›i Ä‘á»£t bÃ¹ng phÃ¡t viÃªm mÅ©i dá»‹ á»©ng.
    HÃ£y theo dÃµi sÃ¡t trong 24â€“48 giá» tá»›i.
```

---

### AR-03 â€“ Nghi ngá» biáº¿n chá»©ng xoang

```yaml
code: AR_03_SINUS_COMPLICATION
if:
  nasal_congestion >= 6
  AND headache >= 6
  AND duration_days >= 3
then:
  severity: WARNING
  message: >
    Ngháº¹t mÅ©i kÃ¨m Ä‘au Ä‘áº§u kÃ©o dÃ i cÃ³ thá»ƒ liÃªn quan Ä‘áº¿n viÃªm xoang.
    Báº¡n nÃªn Ä‘i khÃ¡m Ä‘á»ƒ Ä‘Æ°á»£c kiá»ƒm tra ká»¹ hÆ¡n.
```

---

### AR-04 â€“ ÄÃªm xáº¥u Ä‘i (environmental trigger)

```yaml
code: AR_04_NIGHT_WORSENING
if:
  nasal_congestion_night - nasal_congestion_day >= 3
then:
  severity: INFO
  message: >
    Triá»‡u chá»©ng náº·ng hÆ¡n vÃ o ban Ä‘Ãªm cÃ³ thá»ƒ liÃªn quan Ä‘áº¿n mÃ´i trÆ°á»ng ngá»§
    (bá»¥i, Ä‘iá»u hÃ²a, Ä‘á»™ áº©m).
```

---

# II. ViÃªm da cÆ¡ Ä‘á»‹a (Atopic Dermatitis)

![Image](https://moreliaclinic.com/wp-content/uploads/2023/09/1_2a510819-2335-4b17-92a6-62604ea50560_grande.png.webp)

![Image](https://cdn.shopify.com/s/files/1/0529/7170/0417/files/hormones-eczema-life-stages-timeline.webp?v=1754678761)

![Image](https://warwickfriendlysociety.com.au/wp-content/uploads/2020/08/eczema-chart.jpg)

## 1. Symptom Model

| Code              | MÃ´ táº£              | Scale   |
| ----------------- | ------------------ | ------- |
| itch              | Ngá»©a               | 0â€“10    |
| redness           | Äá» da              | 0â€“10    |
| oozing            | Rá»‰ dá»‹ch            | boolean |
| cracked_skin      | Ná»©t da             | boolean |
| sleep_disturbance | áº¢nh hÆ°á»Ÿng giáº¥c ngá»§ | 0â€“10    |

---

## 2. Alert Rules

### AD-01 â€“ Äá»£t bÃ¹ng phÃ¡t cáº¥p

```yaml
code: AD_01_ACUTE_FLARE
if:
  itch >= 7
  AND redness >= 6
then:
  severity: WARNING
  message: >
    Da cá»§a báº¡n Ä‘ang cÃ³ dáº¥u hiá»‡u bÃ¹ng phÃ¡t viÃªm da cÆ¡ Ä‘á»‹a.
    TrÃ¡nh gÃ£i vÃ  cÃ¢n nháº¯c Ä‘i khÃ¡m da liá»…u náº¿u khÃ´ng cáº£i thiá»‡n.
```

---

### AD-02 â€“ Ngá»©a áº£nh hÆ°á»Ÿng giáº¥c ngá»§ (chá»‰ dáº¥u náº·ng)

```yaml
code: AD_02_SLEEP_IMPACT
if:
  itch >= 6
  AND sleep_disturbance >= 5
then:
  severity: WARNING
  message: >
    Ngá»©a da Ä‘ang áº£nh hÆ°á»Ÿng Ä‘áº¿n giáº¥c ngá»§ cá»§a báº¡n,
    Ä‘Ã¢y lÃ  dáº¥u hiá»‡u bá»‡nh cÃ³ xu hÆ°á»›ng náº·ng hÆ¡n.
```

---

### AD-03 â€“ Nghi nhiá»…m trÃ¹ng da

```yaml
code: AD_03_INFECTION_RISK
if:
  oozing = true
  OR cracked_skin = true
then:
  severity: CRITICAL
  message: >
    VÃ¹ng da cÃ³ dáº¥u hiá»‡u rá»‰ dá»‹ch hoáº·c ná»©t náº».
    Báº¡n nÃªn Ä‘i khÃ¡m da liá»…u sá»›m Ä‘á»ƒ trÃ¡nh nhiá»…m trÃ¹ng.
```

---

### AD-04 â€“ KhÃ´ng cáº£i thiá»‡n theo thá»i gian

```yaml
code: AD_04_NO_IMPROVEMENT
if:
  itch >= 5
  AND duration_days >= 7
then:
  severity: WATCH
  message: >
    Triá»‡u chá»©ng viÃªm da kÃ©o dÃ i nhiá»u ngÃ y.
    Viá»‡c theo dÃµi vÃ  Ä‘iá»u chá»‰nh Ä‘iá»u trá»‹ lÃ  cáº§n thiáº¿t.
```

---

# III. Phá»¥ ná»¯ mang thai (Pregnancy-safe Monitoring)

![Image](https://www.lalpathlabs.com/blog/wp-content/uploads/2016/06/pregnancy-symptoms.jpg)

![Image](https://www.cdc.gov/hearher/images/digital-partner/warning-signs.JPG)

![Image](https://www.envrad.com/content/uploads/2021/12/Womens-Health-Timelines_REV02.png)

âš ï¸ **Rule nghiÃªm ngáº·t â€“ thiÃªn vá» an toÃ n**

---

## 1. Symptom Model

| Code             | MÃ´ táº£            |
| ---------------- | ---------------- |
| vaginal_bleeding | Ra mÃ¡u           |
| abdominal_pain   | Äau bá»¥ng         |
| severe_headache  | Äau Ä‘áº§u dá»¯ dá»™i   |
| blurred_vision   | Má» máº¯t           |
| swelling         | PhÃ¹ tay/chÃ¢n/máº·t |
| fetal_movement   | Thai mÃ¡y giáº£m    |

---

## 2. Alert Rules

### PR-01 â€“ Ra mÃ¡u khi mang thai

```yaml
code: PR_01_BLEEDING
if:
  vaginal_bleeding = true
then:
  severity: CRITICAL
  message: >
    Báº¡n cÃ³ dáº¥u hiá»‡u ra mÃ¡u trong thai ká»³.
    HÃ£y Ä‘áº¿n cÆ¡ sá»Ÿ y táº¿ hoáº·c liÃªn há»‡ bÃ¡c sÄ© ngay láº­p tá»©c.
```

---

### PR-02 â€“ Nghi tiá»n sáº£n giáº­t

```yaml
code: PR_02_PREECLAMPSIA
if:
  severe_headache = true
  AND blurred_vision = true
  AND swelling = true
then:
  severity: CRITICAL
  message: >
    CÃ¡c triá»‡u chá»©ng cá»§a báº¡n cÃ³ thá»ƒ liÃªn quan Ä‘áº¿n tiá»n sáº£n giáº­t.
    ÄÃ¢y lÃ  tÃ¬nh tráº¡ng nguy hiá»ƒm cáº§n Ä‘Æ°á»£c kiá»ƒm tra ngay.
```

---

### PR-03 â€“ Äau bá»¥ng kÃ©o dÃ i

```yaml
code: PR_03_PERSISTENT_PAIN
if:
  abdominal_pain >= 5
  AND duration_hours >= 6
then:
  severity: WARNING
  message: >
    Äau bá»¥ng kÃ©o dÃ i trong thai ká»³ cáº§n Ä‘Æ°á»£c theo dÃµi ká»¹.
    Báº¡n nÃªn liÃªn há»‡ bÃ¡c sÄ© Ä‘á»ƒ Ä‘Æ°á»£c tÆ° váº¥n.
```

---

### PR-04 â€“ Thai mÃ¡y giáº£m

```yaml
code: PR_04_REDUCED_FETAL_MOVEMENT
if:
  fetal_movement = decreased
then:
  severity: CRITICAL
  message: >
    Thai mÃ¡y giáº£m lÃ  dáº¥u hiá»‡u cáº§n Ä‘Æ°á»£c kiá»ƒm tra sá»›m.
    HÃ£y Ä‘áº¿n bá»‡nh viá»‡n hoáº·c gá»i bÃ¡c sÄ© ngay.
```

---

# IV. Global Safety Rules (Ãp dá»¥ng chung)

```yaml
if:
  severity = CRITICAL
then:
  bypass_cooldown: true
  push_immediate: true
```

```yaml
if:
  user_ignores_alert >= 2
then:
  escalate_message: true
```

---

# V. VÃ¬ sao rule set nÃ y phÃ¹ há»£p MVP?

âœ… KhÃ´ng cháº©n Ä‘oÃ¡n
âœ… Giáº£i thÃ­ch Ä‘Æ°á»£c
âœ… Ãt false-positive
âœ… PhÃ¹ há»£p phÃ¡p lÃ½
âœ… Dá»… review bá»Ÿi bÃ¡c sÄ©

---

DÆ°á»›i Ä‘Ã¢y lÃ  **thiáº¿t káº¿ Timeline UX + Data Model + Logic hiá»ƒn thá»‹** Ä‘á»ƒ **user chá»‰ cáº§n 5â€“10 giÃ¢y lÃ  náº¯m Ä‘Æ°á»£c: â€œTÃ´i Ä‘ang á»•n hÆ¡n hay tá»‡ hÆ¡n?â€**, Ä‘Ãºng tinh tháº§n sáº£n pháº©m y táº¿ cá»§a báº¡n.

---

# 1. Má»¥c tiÃªu cá»§a Timeline (ráº¥t quan trá»ng)

Timeline **KHÃ”NG** Ä‘á»ƒ:

* Liá»‡t kÃª log y táº¿ âŒ
* Xem nhÆ° medical record âŒ

Timeline **PHáº¢I** tráº£ lá»i ngay 3 cÃ¢u há»i:

1. ğŸ“ˆ **Xu hÆ°á»›ng**: Ä‘ang tá»‘t lÃªn hay xáº¥u Ä‘i?
2. âš ï¸ **Äiá»ƒm báº¥t thÆ°á»ng**: khi nÃ o báº¯t Ä‘áº§u?
3. ğŸ§­ **HÃ nh Ä‘á»™ng tiáº¿p theo**: nÃªn lÃ m gÃ¬?

ğŸ‘‰ **Trend > Event list**

---

# 2. Mental Model cho User

> **Timeline giá»‘ng â€œGoogle Maps cho sá»©c khá»eâ€**
> KhÃ´ng cáº§n biáº¿t má»i chi tiáº¿t, chá»‰ cáº§n:

* Äang Ä‘i Ä‘Ãºng hÆ°á»›ng khÃ´ng?
* CÃ³ chá»— nÃ o nguy hiá»ƒm phÃ­a trÆ°á»›c khÃ´ng?

---

# 3. Cáº¥u trÃºc Timeline (3 lá»›p â€“ Progressive Disclosure)

![Image](https://cdn.dribbble.com/userupload/45037774/file/8ed946d79fcd2446ad3618e10ac2bd37.png)

![Image](https://i.etsystatic.com/36460112/r/il/e9a3a8/4232695475/il_570xN.4232695475_k6va.jpg)

![Image](https://cdn.prod.website-files.com/62bc8dd8ce4de7cc79849be4/68778335a42fdbbf27f871b3_67f0d0e3f9f61be85bdf09e6_Copy%2520of%2520Dev%2520screenshot%2520stories%2520%287%29.gif)

![Image](https://cdn.prod.website-files.com/59f82cced3f5090001bfcff8/5e4ed8eb5c12865fdca3ccb8_xLzxCE_n1nrdaSDYFy7Z67EkE2-PLqSsIXw4BRi9tM43fAtzRcfu203Phpqce8Bn2ItFgkLNcDq2IbHOtOE4unRIEQGY5eGCaOD-ihmO1y8j9AQcZsZlQgLkPQoS20L3mYVhHLFd.png)

## Layer 1 â€“ Health Status Header (Above the fold)

**LuÃ´n hiá»ƒn thá»‹ trÃªn cÃ¹ng**

```
ğŸŸ¡ ÄANG THEO DÃ•I
Triá»‡u chá»©ng chÃ­nh: Ngháº¹t mÅ©i (â†— tÄƒng nháº¹)
3 ngÃ y gáº§n Ä‘Ã¢y cÃ³ xu hÆ°á»›ng náº·ng hÆ¡n
```

**Bao gá»“m**

* Status badge (ğŸŸ¢ğŸŸ¡ğŸŸ ğŸ”´)
* Symptom chÃ­nh
* Trend arrow (â†— â†˜ â†’)
* Insight 1 cÃ¢u (auto-generated)

ğŸ‘‰ User hiá»ƒu tÃ¬nh tráº¡ng **trong 2 giÃ¢y**

---

## Layer 2 â€“ Visual Trend Strip (7 ngÃ y)

```
Day:  T-6  T-5  T-4  T-3  T-2  T-1  Today
      â–‚    â–ƒ    â–„    â–…    â–†    â–†     â–‡
```

* Bar / dot chart cá»±c Ä‘Æ¡n giáº£n
* Má»—i cá»™t = severity tá»•ng há»£p ngÃ y
* MÃ u theo risk

ğŸ‘‰ NhÃ¬n **báº±ng máº¯t**, khÃ´ng cáº§n Ä‘á»c

---

## Layer 3 â€“ Event Timeline (Scroll)

```
â”€â”€â”€â”€â”€â”€â”€â”€ Today â”€â”€â”€â”€â”€â”€â”€â”€
ğŸ”´ Alert: Ngháº¹t mÅ©i kÃ©o dÃ i 5 ngÃ y
ğŸ’Š Uá»‘ng thuá»‘c khÃ¡ng dá»‹ á»©ng
ğŸ“˜ Gá»£i Ã½: Dá»‹ á»©ng theo mÃ¹a

â”€â”€â”€â”€â”€â”€â”€â”€ Yesterday â”€â”€â”€â”€â”€
ğŸŸ  Ngháº¹t mÅ©i: 6/10
ğŸŸ  Háº¯t hÆ¡i: 12 láº§n
ğŸ˜´ Ngá»§ kÃ©m

â”€â”€â”€â”€â”€â”€â”€â”€ 3 days ago â”€â”€â”€â”€
ğŸŸ¡ Ngháº¹t mÅ©i: 4/10
```

* Chá»‰ hiá»ƒn thá»‹ **event cÃ³ Ã½ nghÄ©a**
* KhÃ´ng spam raw logs

---

# 4. Event Types & Icon System (chuáº©n hÃ³a)

| Type       | Icon  | Ã nghÄ©a           |
| ---------- | ----- | ----------------- |
| Symptom    | ğŸ¤§ ğŸ©¹ | Thay Ä‘á»•i sá»©c khá»e |
| Alert      | âš ï¸ ğŸ”´ | Äiá»ƒm cáº§n chÃº Ã½    |
| Medication | ğŸ’Š    | Can thiá»‡p         |
| Knowledge  | ğŸ“˜    | Hiá»ƒu thÃªm         |
| Milestone  | ğŸ    | Cá»™t má»‘c           |

ğŸ‘‰ User nháº­n biáº¿t báº±ng icon, khÃ´ng cáº§n Ä‘á»c chá»¯

---

# 5. Insight Engine (Timeline khÃ´ng chá»‰ lÃ  UI)

Má»—i ngÃ y sinh **1 Insight tá»± Ä‘á»™ng**:

### VÃ­ dá»¥ (viÃªm mÅ©i dá»‹ á»©ng)

> â€œTriá»‡u chá»©ng ngháº¹t mÅ©i cá»§a báº¡n tÄƒng dáº§n trong 3 ngÃ y gáº§n Ä‘Ã¢y, Ä‘áº·c biá»‡t náº·ng hÆ¡n vÃ o ban Ä‘Ãªm.â€

**Rule sinh insight**

```yaml
if:
  severity_trend = increasing
  AND night > day
then:
  insight_type: trend
```

ğŸ‘‰ Timeline = **story**, khÃ´ng pháº£i log

---

# 6. Drill-down cÃ³ kiá»ƒm soÃ¡t (Optional)

User tap vÃ o event:

### Alert Detail

* VÃ¬ sao alert xuáº¥t hiá»‡n
* Rule nÃ o kÃ­ch hoáº¡t
* Dá»¯ liá»‡u liÃªn quan (3 ngÃ y)

âš ï¸ **KhÃ´ng hiá»ƒn thá»‹ thuáº­t ngá»¯ y khoa khÃ³**

---

# 7. Timeline cho 3 nhÃ³m báº¡n chá»n

## 7.1 ViÃªm mÅ©i dá»‹ á»©ng

* Highlight: **ngÃ y â†” Ä‘Ãªm**
* Gáº¯n knowledge card theo mÃ¹a
* Group symptom theo â€œmÅ©i â€“ Ä‘áº§u â€“ má»‡tâ€

## 7.2 ViÃªm da cÆ¡ Ä‘á»‹a

* Group theo **Ä‘á»£t bÃ¹ng phÃ¡t**
* ÄÃ¡nh dáº¥u â€œflare start / flare endâ€
* Nháº¥n máº¡nh áº£nh hÆ°á»Ÿng giáº¥c ngá»§

## 7.3 Phá»¥ ná»¯ mang báº§u

* Timeline **theo tuáº§n thai**
* Event nguy hiá»ƒm luÃ´n **pin trÃªn top**
* Ãt dá»¯ liá»‡u nhÆ°ng **severity cao**

---

# 8. Data Model cho Timeline (Mapping vá»›i DB)

```text
timeline_event {
  id
  user_id
  occurred_at
  type: symptom | alert | medication | insight
  severity: info | watch | warning | critical
  title
  summary
  ref_id
}
```

ğŸ‘‰ Timeline chá»‰ consume **processed data**, khÃ´ng raw

---

# 9. Performance & UX cho MVP

* Load máº·c Ä‘á»‹nh: 7 ngÃ y
* Lazy load theo scroll
* Cache insight 24h
* Skeleton UI (y táº¿ ráº¥t cáº§n cáº£m giÃ¡c tin cáº­y)

---

# 10. NguyÃªn táº¯c vÃ ng (ráº¥t quan trá»ng)

âœ… Timeline pháº£i:

* Ãt chá»¯
* Nhiá»u tÃ­n hiá»‡u
* CÃ³ nhá»‹p Ä‘iá»‡u (rhythm)

âŒ Timeline khÃ´ng Ä‘Æ°á»£c:

* LÃ  medical chart
* Khiáº¿n user lo láº¯ng vÃ´ cá»›
* Báº¯t user â€œÄ‘á»c vÃ  suy nghÄ©â€

---
